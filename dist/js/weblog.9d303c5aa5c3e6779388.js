!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Weblog=t():e.Weblog=t()}(window,function(){return r={},o.m=n=[function(e,t,n){e.exports=n(5)},function(e,t){function c(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}e.exports=function(u){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=u.apply(e,a);function o(e){c(r,t,n,o,i,"next",e)}function i(e){c(r,t,n,o,i,"throw",e)}o(void 0)})}}},function(e,t,n){"use strict";var u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,a,u,c){return new(u=u||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})},c=this&&this.__generator||function(n,r){var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),s=n(7),l=n(3),f=!0;function i(e){if(l.paramChecker(e,l.ParamCheckerEnum.NotNullObject,"tableIndexRange",!f),l.paramChecker(e.tableName,l.ParamCheckerEnum.String,"tableIndexRange's",!f),l.paramChecker(e.indexRange,l.ParamCheckerEnum.NotNullObject,"tableIndexRange's indexRange",f),e.indexRange){var t=e.indexRange,n=t.indexName,r=t.onlyIndex,o=t.lowerIndex,i=t.upperIndex,a=t.lowerExclusive,u=t.upperExclusive;if(l.paramChecker(n,l.ParamCheckerEnum.String,"indexRange's indexName",!f),void 0===r&&void 0===o&&void 0===i)throw new Error("indexRange should have bounds or value for the index");if(void 0!==o&&void 0!==i&&i<=o)throw new Error("lowerIndex should be less than upperIndex");o&&i&&l.paramChecker(a,l.ParamCheckerEnum.Boolean,"indexRange's lowerExclusive",f),l.paramChecker(u,l.ParamCheckerEnum.Boolean,"indexRange's upperExclusive",f)}}function a(){try{return r.default(),!0}catch(e){return!1}}t.idbIsSupported=a;var h=(d.prototype.addItems=function(a){return o(this,void 0,void 0,function(){var r,o,i=this;return c(this,function(e){switch(e.label){case 0:return r=function(e,t,n){return void 0!==n?n:void 0!==t?t:e},t=a,n=this.tableList,l.paramChecker(t,l.ParamCheckerEnum.Array,"items",!f),t.forEach(function(t){l.paramChecker(t.tableName,l.ParamCheckerEnum.String,"item's tableName",!f),l.paramChecker(t.itemDuration,l.ParamCheckerEnum.NonNegativeInteger,"item's itemDuration",f);var e=n.filter(function(e){return e.tableName===t.tableName})[0];if(!e)throw new Error("Table "+t.tableName+" does not exist");if(void 0!==e.primaryKey&&Object.getOwnPropertyNames(t.item).indexOf(e.primaryKey)<0)throw new Error("primaryKey is needed for item in table "+t.tableName)}),o=a.map(function(t){var e=i.tableList.filter(function(e){return e.tableName===t.tableName})[0];return u({itemDuration:r(i.itemDuration,e.itemDuration,t.itemDuration)},t)}),[4,s.default.addItems({name:this.name,tableList:this.tableList,version:this.version},o)];case 1:return e.sent(),[2]}var t,n})})},d.prototype.getItem=function(t,n){return o(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,m(this.name,t,n)];case 1:return[2,e.sent()]}})})},d.prototype.getItemsInRange=function(t){return o(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,y(this.name,t)];case 1:return[2,e.sent()]}})})},d.prototype.deleteItemsInRange=function(t){return o(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return l.paramChecker(t,l.ParamCheckerEnum.Array,"tableIndexRanges",!f),t.forEach(function(e){i(e)}),[4,s.default.deleteItems(this.name,t)];case 1:return e.sent(),[2]}})})},d);function d(t){var n;r.default(),n=t,l.paramChecker(n,l.ParamCheckerEnum.NotNullObject,"dbConfig",!f),l.paramChecker(n.dbName,l.ParamCheckerEnum.String,"dbName",!f),l.paramChecker(n.dbVersion,l.ParamCheckerEnum.NonNegativeInteger,"dbVersion",f),l.paramChecker(n.itemDuration,l.ParamCheckerEnum.NonNegativeInteger,"itemDuration of dbConfig",f),l.paramChecker(n.tables,l.ParamCheckerEnum.NotNullObject,"tables",f),Object.keys(n.tables||{}).forEach(function(e){var t=n.tables[e];l.paramChecker(t.primaryKey,l.ParamCheckerEnum.String,"primaryKey",f),l.paramChecker(t.itemDuration,l.ParamCheckerEnum.NonNegativeInteger,"itemDuration of table",f),l.paramChecker(t.indexList,l.ParamCheckerEnum.Array,"indexList",f),(t.indexList||[]).forEach(function(e){l.paramChecker(e.indexName,l.ParamCheckerEnum.String,"indexName",!f),l.paramChecker(e.unique,l.ParamCheckerEnum.Boolean,"unique",f)})}),this.name=t.dbName,this.version=l.optionWithBackup(t.dbVersion,1),this.tableList=Object.keys(t.tables||{}).map(function(e){return u({tableName:e},t.tables[e])}),this.itemDuration=t.itemDuration}function p(t){return o(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return r.default(),l.paramChecker(t,l.ParamCheckerEnum.String,"dbName",!f),[4,s.default.deleteDB(t)];case 1:return e.sent(),[2]}})})}function m(t,n,r){return o(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return l.paramChecker(t,l.ParamCheckerEnum.String,"dbName",!f),l.paramChecker(n,l.ParamCheckerEnum.String,"tableName",!f),[4,s.default.getItem(t,n,r)];case 1:return[2,e.sent()]}})})}function y(t,n){return o(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return l.paramChecker(t,l.ParamCheckerEnum.String,"dbName",!f),i(n),[4,s.default.getItemsInRange(t,n)];case 1:return[2,e.sent()]}})})}t.CustomDB=h,t.deleteDB=p,t.getItemFromDB=m,t.getItemsInRangeFromDB=y,t.default={idbIsSupported:a,CustomDB:h,deleteDB:p,getItemFromDB:m,getItemsInRangeFromDB:y}},function(e,t,n){"use strict";function r(e){return!isNaN(e)&&0<=e}Object.defineProperty(t,"__esModule",{value:!0}),t.ParamCheckerEnum={NonNegativeInteger:{rule:r,desc:"needs to be a non-negative integer"},NotNullObject:{rule:function(e){return e&&"object"==typeof e},desc:"needs to be a not-null object"},String:{rule:function(e){return"string"==typeof e},desc:"needs to be a string"},Array:{rule:function(e){return e instanceof Array},desc:"needs to be an Array"},Boolean:{rule:function(e){return"boolean"==typeof e},desc:"needs to be a boolean"}},t.isNonNegativeInteger=r,t.optionWithBackup=function(e,t){return void 0!==e?e:t},t.paramChecker=function(e,t,n,r){var o=n+" "+t.desc;if(r){if(void 0!==e&&!t.rule(e))throw new Error(o+" if defined")}else if(!t.rule(e))throw new Error(o)},t.deduplicateList=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0?e.concat(t):e},[])}},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(e){return typeof e}:t.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}t.exports=n},function(e,t,n){var r=function(a){"use strict";var f,e=Object.prototype,l=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function u(e,t,n,r){var i,a,u,c,o=t&&t.prototype instanceof v?t:v,s=Object.create(o.prototype),l=new k(r||[]);return s._invoke=(i=e,a=n,u=l,c=d,function(e,t){if(c===m)throw new Error("Generator is already running");if(c===y){if("throw"===e)throw t;return j()}for(u.method=e,u.arg=t;;){var n=u.delegate;if(n){var r=function e(t,n){var r=t.iterator[n.method];if(r===f){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=f,e(t,n),"throw"===n.method))return b;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var o=h(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,b;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=f),n.delegate=null,b):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}(n,u);if(r){if(r===b)continue;return r}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===d)throw c=y,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=m;var o=h(i,a,u);if("normal"===o.type){if(c=u.done?y:p,o.arg===b)continue;return{value:o.arg,done:u.done}}"throw"===o.type&&(c=y,u.method="throw",u.arg=o.arg)}}),s}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=u;var d="suspendedStart",p="suspendedYield",m="executing",y="completed",b={};function v(){}function i(){}function c(){}var s={};s[o]=function(){return this};var g=Object.getPrototypeOf,w=g&&g(g(D([])));w&&w!==e&&l.call(w,o)&&(s=w);var x=c.prototype=v.prototype=Object.create(s);function I(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function N(c,s){var t;this._invoke=function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,o){var i=h(c[e],c,n);if("throw"!==i.type){var a=i.arg,u=a.value;return u&&"object"==typeof u&&l.call(u,"__await")?s.resolve(u.__await).then(function(e){t("next",e,r,o)},function(e){t("throw",e,r,o)}):s.resolve(u).then(function(e){a.value=e,r(a)},function(e){return t("throw",e,r,o)})}o(i.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function D(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=f,e.done=!0,e};return r.next=r}}return{next:j}}function j(){return{value:f,done:!0}}return i.prototype=x.constructor=c,c.constructor=i,c[r]=i.displayName="GeneratorFunction",a.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===i||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,r in e||(e[r]="GeneratorFunction")),e.prototype=Object.create(x),e},a.awrap=function(e){return{__await:e}},I(N.prototype),N.prototype[n]=function(){return this},a.AsyncIterator=N,a.async=function(e,t,n,r,o){void 0===o&&(o=Promise);var i=new N(u(e,t,n,r),o);return a.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},I(x),x[r]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},a.keys=function(n){var r=[];for(var e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=D,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=f,this.done=!1,this.delegate=null,this.method="next",this.arg=f,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=f)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return i.type="throw",i.arg=n,r.next=e,t&&(r.method="next",r.arg=f),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],i=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=l.call(o,"catchLoc"),u=l.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r,o=n.completion;return"throw"===o.type&&(r=o.arg,E(n)),r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=f),b}},a}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!window)throw new Error("idb-managed can not run in non-browser environment");for(var e=0,t=["indexedDB","IDBDatabase","IDBObjectStore","IDBTransaction","IDBIndex","IDBCursor","IDBKeyRange","IDBRequest"];e<t.length;e++){var n=t[e];if(!window.hasOwnProperty(n)||!window[n])throw new Error(n+" is not supported in window")}}},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=this&&this.__awaiter||function(e,a,u,c){return new(u=u||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})},l=this&&this.__generator||function(n,r){var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){u.label=t[1];break}if(6===t[0]&&u.label<a[1]){u.label=a[1],a=t;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(t);break}a[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(3),o=n(8),r=1,a="IDB_MANAGER_DB",s="IDB_MANAGER_STORE",f="dbName",h="updateTime",d="expireTime";function p(e){var t=e.onlyIndex,n=e.lowerIndex,r=e.upperIndex,o=e.lowerExclusive,i=void 0!==o&&o,a=e.upperExclusive,u=void 0!==a&&a;return void 0!==t?IDBKeyRange.only(t):void 0!==n&&void 0!==r?IDBKeyRange.bound(n,r,i,u):void 0!==n?IDBKeyRange.lowerBound(n,i):IDBKeyRange.upperBound(r,u)}function m(e){var t,n=Date.now();return i(i({},e.item),((t={})[h]=n,t[d]=void 0!==e.itemDuration?e.itemDuration+n:-1,t))}function y(e){return!e||0<e.expireTime&&e.expireTime<Date.now()?null:(delete e.updateTime,delete e.expireTime,e)}function b(t){return u(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,function(a){return u(this,void 0,void 0,function(){var t,n,r,o,i;return l(this,function(e){switch(e.label){case 0:return[4,v()];case 1:return[4,w(t=e.sent(),s,a.name)];case 2:return!(n=e.sent())||a.version>n.version?(r=t.transaction(s,"readwrite"),o=r.objectStore(s),i={dbName:a.name,tableList:a.tableList,version:a.version},o.put(m({item:i,tableName:s})),[4,r.complete]):[3,4];case 3:e.sent(),t.close(),e.label=4;case 4:return[2]}})})}(t)];case 1:return e.sent(),[4,o.open(t.name,t.version,function(e){x(e,t.tableList)})];case 2:return[2,e.sent()]}})})}function v(){return u(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,o.open(a,r,function(e){e.createObjectStore(s,{keyPath:f})})];case 1:return[2,e.sent()]}})})}function g(r){return u(this,void 0,void 0,function(){var t,n;return l(this,function(e){switch(e.label){case 0:return[4,v()];case 1:return[4,w(t=e.sent(),s,r)];case 2:return n=e.sent(),t.close(),n?[4,o.open(n.dbName,n.version,function(e){x(e,n.tableList||[])})]:[3,4];case 3:return[2,e.sent()];case 4:return[2,null]}})})}function w(n,r,o){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return n.objectStoreNames.contains(r)?(t=n.transaction(r,"readonly"),[4,t.objectStore(r).get(o)]):[3,2];case 1:return[2,y(e.sent())];case 2:return[2,null]}})})}function x(o,e){try{e.forEach(function(e){var t,n,r;o.objectStoreNames.contains(e.tableName)?(t=o.transaction(e.tableName).objectStore(e.tableName),(e.indexList||[]).forEach(function(e){t.indexNames.contains(e.indexName)||t.createIndex(e.indexName,e.indexName,{unique:e.unique})})):(n=e.primaryKey||"id",(r=o.createObjectStore(e.tableName,i({keyPath:n},"id"===n?{autoIncrement:!0}:{}))).createIndex(n,n,{unique:!0}),(e.indexList||[]).forEach(function(e){r.createIndex(e.indexName,e.indexName,{unique:e.unique})}),r.createIndex(h,h,{unique:!1}),r.createIndex(d,d,{unique:!1}))})}catch(e){o.close()}}function I(n,r,o){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,8,9]),[4,o()];case 1:return e.sent(),[4,n.complete];case 2:return e.sent(),[3,9];case 3:t=e.sent();try{n.abort()}catch(e){}e.label=4;case 4:return e.trys.push([4,6,,7]),[4,n.complete];case 5:return e.sent(),[3,7];case 6:return e.sent(),[3,7];case 7:throw t;case 8:return r.close(),[7];case 9:return[2]}})})}function N(i,a){return u(this,void 0,void 0,function(){var t,n,r,o=this;return l(this,function(e){switch(e.label){case 0:return t=c.deduplicateList(a.map(function(e){return e.tableName})),[4,D(i.name,t.map(function(e){return{tableName:e,indexRange:{indexName:d,upperIndex:+new Date,upperExclusive:!1}}}))];case 1:return e.sent(),[4,b(i)];case 2:return n=e.sent(),[4,I(r=n.transaction(t,"readwrite"),n,function(){return u(o,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,Promise.all(a.map(function(e){return r.objectStore(e.tableName).put(m(e))}))];case 1:return e.sent(),[2]}})})})];case 3:return e.sent(),[2]}})})}function _(n,r,o){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return[4,g(n)];case 1:if(!(t=e.sent()))return[3,7];e.label=2;case 2:return e.trys.push([2,4,5,6]),[4,w(t,r,o)];case 3:return[2,e.sent()];case 4:throw e.sent();case 5:return t.close(),[7];case 6:return[3,8];case 7:return[2,null];case 8:return[2]}})})}function E(c,s){return u(this,void 0,void 0,function(){var t,r,n,o,i,a,u;return l(this,function(e){switch(e.label){case 0:return t=s.tableName,r=s.indexRange,[4,g(c)];case 1:if(!(n=e.sent()))return[3,11];e.label=2;case 2:return e.trys.push([2,8,9,10]),o=[],n.objectStoreNames.contains(t)?[3,3]:[3,7];case 3:return i=n.transaction(t,"readonly"),a=i.objectStore(t),r?[3,5]:[4,a.getAll()];case 4:return u=e.sent(),o=(u||[]).map(y).filter(function(e){return null!==e}),[3,7];case 5:return[4,new Promise(function(n){a.index(r.indexName).iterateCursor(p(r),function(e){var t;e?((t=y(e.value))&&o.push(t),e.continue()):n()})})];case 6:e.sent(),e.label=7;case 7:return[2,o];case 8:throw e.sent();case 9:return n.close(),[7];case 10:return[3,12];case 11:return[2,[]];case 12:return[2]}})})}function k(t){return u(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,function(r){return u(this,void 0,void 0,function(){var t,n;return l(this,function(e){switch(e.label){case 0:return[4,v()];case 1:return t=e.sent(),n=t.transaction(s,"readwrite"),n.objectStore(s).delete(r),[4,n.complete];case 2:return e.sent(),t.close(),[2]}})})}(t)];case 1:return e.sent(),[4,o.delete(t)];case 2:return e.sent(),[2]}})})}function D(n,r){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return[4,g(n)];case 1:return(t=e.sent())?[4,function(i,a){return u(this,void 0,void 0,function(){var t,n,o,r=this;return l(this,function(e){switch(e.label){case 0:return t=a.filter(function(e){return i.objectStoreNames.contains(e.tableName)}),n=c.deduplicateList(t.map(function(e){return e.tableName})),[4,I(o=i.transaction(n,"readwrite"),i,function(){return u(r,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(e){var t=e.tableName,n=e.indexRange,r=o.objectStore(t);return n?new Promise(function(t){r.index(n.indexName).iterateCursor(p(n),function(e){e?(r.delete(e.primaryKey),e.continue()):t()})}):r.clear()}))];case 1:return e.sent(),[2]}})})})];case 1:return e.sent(),[2]}})})}(t,r)]:[3,3];case 2:return e.sent(),[3,4];case 3:case 4:return[2]}})})}t.addItems=N,t.getItem=_,t.getItemsInRange=E,t.deleteDB=k,t.deleteItems=D,t.default={addItems:N,getItem:_,getItemsInRange:E,deleteDB:k,deleteItems:D}},function(e,t){function a(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,r,o){var i,e=new Promise(function(e,t){a(i=n[r].apply(n,o)).then(e,t)});return e.request=i,e}function n(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function r(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function o(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function u(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=i(e,n,arguments)).then(function(e){if(e)return new s(e,t.request)});var e,t})})}function c(e){this._index=e}function s(e,t){this._cursor=e,this._request=t}function l(e){this._store=e}function f(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function h(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new f(n)}function d(e){this._db=e}var p,m;l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},h.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},m=function(){try{return["IDBIndex","IDBCursor","IDBObjectStore","IDBTransaction","IDBDatabase"].forEach(function(e){if(window&&(!window[e]||!window.hasOwnProperty(e)))throw new Error(e)}),1}catch(e){return}}()?(n(c,"_index",["name","keyPath","multiEntry","unique"]),r(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(s,"_cursor",["direction","key","primaryKey","value"]),r(s,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(s.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),a(t._request).then(function(e){if(e)return new s(e,t._request)})})})}),n(l,"_store",["name","keyPath","indexNames","autoIncrement"]),r(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(l,"_store",IDBObjectStore,["deleteIndex"]),n(f,"_tx",["objectStoreNames","mode"]),o(f,"_tx",IDBTransaction,["abort"]),n(h,"_db",["name","version","objectStoreNames"]),o(h,"_db",IDBDatabase,["deleteObjectStore","close"]),n(d,"_db",["name","version","objectStoreNames"]),o(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[l,c].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,o=r[i].apply(r,t.slice(0,-1));o.onsuccess=function(){n(o.result)}})})}),[c,l].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,o=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(o.push(e.value),void 0===n||o.length!=n?e.continue():t(o)):t(o)})})})}),{open:function(e,t,n){var r=i(indexedDB,"open",[e,t]),o=r.request;return o&&(o.onupgradeneeded=function(e){n&&n(new h(o.result,e.oldVersion,o.transaction))}),r.then(function(e){return new d(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}}):(p="indexedDB is not supported",{open:function(){return Promise.reject(new Error(p))},delete:function(){return Promise.reject(new Error(p))}}),e.exports=m},function(e,t,n){"use strict";n.r(t),n.d(t,"WebLog",function(){return v});var r=n(4),c=n.n(r),o=n(0),s=n.n(o),i=n(1),a=n.n(i),u=n(2);function l(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+":"+e.getTime().toString().slice(-3)}function f(e){var t=document.createElement("a");t.download="write_log_"+l(new Date)+"_"+Number(new Date)+".txt",t.style.display="none";var n=new Blob([e]);t.href=URL.createObjectURL(n),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function h(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var p=6048e5;function m(e){var t;Object(u.idbIsSupported)()?(t="BUTEL_LOG_"+e,this.appid=t,this.db=new u.CustomDB({dbName:t,dbVersion:1,itemDuration:p,tables:{log_detail_table:{indexList:[{indexName:"logCreateTime",unique:!1},{indexName:"logString",unique:!1},{indexName:"type",unique:!1}],itemDuration:p}}})):console.log("IndexedDB is supported: false")}function y(e,t){return b.apply(this,arguments)}function b(){return(b=a()(s.a.mark(function e(t,n){var r,o,i,a,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Array.prototype.slice.call(t,0),this.db){e.next=4;break}return console.log("IndexedDB is supported: false"),e.abrupt("return");case 4:o="",i=h(r);try{for(i.s();!(a=i.n()).done;)u=a.value,o+="object"===c()(u)?JSON.stringify(u):u}catch(e){i.e(e)}finally{i.f()}return e.next=9,this.db.addItems([{tableName:"log_detail_table",item:{logCreateTime:l(new Date),type:n,logString:o}}]);case 9:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}m.prototype.log=a()(s.a.mark(function e(){var t=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.call(this,t,"log");case 2:case"end":return e.stop()}},e,this)})),m.prototype.info=a()(s.a.mark(function e(){var t=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.call(this,t,"info");case 2:case"end":return e.stop()}},e,this)})),m.prototype.warn=a()(s.a.mark(function e(){var t=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.call(this,t,"warn");case 2:case"end":return e.stop()}},e,this)})),m.prototype.error=a()(s.a.mark(function e(){var t=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.call(this,t,"error");case 2:case"end":return e.stop()}},e,this)})),m.prototype.downloadLog=function(){var n=a()(s.a.mark(function e(t,n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return console.log("IndexedDB is supported: false"),e.abrupt("return");case 3:return t=t||new Date-p,n=n||new Date,e.next=7,this.db.getItemsInRange({tableName:"log_detail_table",indexRange:{indexName:"updateTime",upperIndex:n,upperExclusive:!0,lowerIndex:t,lowerExclusive:!0}}).then(function(e){var t="";e.forEach(function(e){2e6<=(t+="【".concat(e.logCreateTime,"】 ").concat(e.type,"日志  <---\x3e  ").concat(e.logString,"\n")).length&&(f(t.slice(0,2e6)),t=t.slice(2e6))})});case 7:case"end":return e.stop()}},e,this)}));return function(e,t){return n.apply(this,arguments)}}(),m.prototype.deleteLog=function(){var e=a()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return console.log("IndexedDB is supported: false"),e.abrupt("return");case 3:return e.next=5,Object(u.deleteDB)(this.appid);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();var v=m;t.default=m}],o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o(o.s=9).default;function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}var n,r});